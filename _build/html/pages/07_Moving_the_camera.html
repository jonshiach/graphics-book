

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>7. Moving the camera &#8212; Computer Graphics Labs</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"vec": ["\\mathbf{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pages/07_Moving_the_camera';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8. Lighting" href="08_Lighting.html" />
    <link rel="prev" title="6. 3D Worlds" href="06_3D_worlds.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Computer Graphics
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_intro_to_cpp.html">1. Introduction to C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_basic_shapes_in_OpenGL.html">2. Basic Shapes in OpenGL</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_textures.html">3. Textures</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_vectors_and_matrices.html">4. Vectors and Matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_transformations.html">5. Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_3D_worlds.html">6. 3D Worlds</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. Moving the camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_Lighting.html">8. Lighting</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_Normal_mapping.html">9. Normal Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="10_Quaternions.html">10. Quaternions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="A_Complex_numbers_and_quaternions.html">A. Complex Numbers and Quaternions</a></li>
<li class="toctree-l1"><a class="reference internal" href="B_Code.html">B. Code and Assets</a></li>
<li class="toctree-l1"><a class="reference internal" href="C_Glossary.html">C Glossary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jonshiach/graphics-labs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jonshiach/graphics-labs/issues/new?title=Issue%20on%20page%20%2Fpages/07_Moving_the_camera.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/pages/07_Moving_the_camera.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Moving the camera</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-keyboard-input-to-move-the-camera">7.1. Using keyboard input to move the camera</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#camera-movement-speed">7.1.1. Camera movement speed</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-mouse-to-point-the-camera">7.2. Using the mouse to point the camera</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pitch-and-yaw">7.2.1. Pitch and yaw</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constraining-the-pitch-angle">7.2.2. Constraining the pitch angle</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#back-face-culling">7.3. Back face culling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">7.4. Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-code">7.5. Source code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video-walkthrough">7.6. Video walkthrough</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="moving-the-camera">
<span id="moving-the-camera-section"></span><h1><span class="section-number">7. </span>Moving the camera<a class="headerlink" href="#moving-the-camera" title="Permalink to this heading">#</a></h1>
<p>In <a class="reference internal" href="06_3D_worlds.html#d-worlds-section"><span class="std std-ref">Lab 6</span></a> we saw how we use transformations to build a 3D world, align the world to the camera position and project the view space onto the screen space. We also created a Camera class that performs these calculations, the next step is to modify the Camera class to by able to move and direct the camera around the 3D world.</p>
<p>Download and build the project files for this lab.</p>
<ol class="arabic simple">
<li><p>Go to <a href="https://github.com/jonshiach/Lab07_Moving_the_camera" target="_blank">https://github.com/jonshiach/Lab07_Moving_the_camera</a> and follow the instructions to download and build the project files.</p></li>
<li><p>Open the project file <code class="docutils literal notranslate"><span class="pre">Lab07_Moving_the_camera.sln</span></code> (or <code class="docutils literal notranslate"><span class="pre">Lab07_Moving_the_camera.xcodeproj</span></code> on macOS) set the <strong>Lab07_Moving_the_camera</strong> project as the startup project.</p>
<ul class="simple">
<li><p>Visual Studio: right-click on the <strong>Lab07_Moving_the_camera</strong> project and select <strong>Set as Startup Project</strong>.</p></li>
<li><p>Xcode: Click on the target select dropdown (to the right of the name of the project at the top of the window) and select <strong>Lab07_Moving_the_camera</strong> as the target.</p></li>
</ul>
</li>
<li><p>Build the project by pressing CTRL + B (or ⌘B on Xcode) which should build the project without errors. Run the executable by pressing F5 (or ⌘R on Xcode).</p></li>
</ol>
<p>Compile and run the project and you will see the multiple cube example we had at the end of the last lab.</p>
<section id="using-keyboard-input-to-move-the-camera">
<h2><span class="section-number">7.1. </span>Using keyboard input to move the camera<a class="headerlink" href="#using-keyboard-input-to-move-the-camera" title="Permalink to this heading">#</a></h2>
<p>The first thing we are going to do is to get keyboard input from the user and use it to move the camera. If you take a look at <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> we have used the function <code class="docutils literal notranslate"><span class="pre">glfwSetInputMode(window,</span> <span class="pre">GLFW_STICKY_KEYS,</span> <span class="pre">GL_TRUE)</span></code> which captures keyboard inputs for the <code class="docutils literal notranslate"><span class="pre">window</span></code> object and the do/while render loop checks for whether the escape key has been pressed to terminate the application. We are going to do similar for other keys.</p>
<p>We are going to modify the <code class="docutils literal notranslate"><span class="pre">calculateMatrices()</span></code> method from the Camera class so that it can take inputs from the keyboard. To do this edit the <code class="docutils literal notranslate"><span class="pre">camera.hpp</span></code> file so that the method declaration takes in an input of a GLFW window object.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">calculateMatrices</span><span class="p">(</span><span class="n">GLFWwindow</span><span class="o">*</span><span class="w"> </span><span class="n">window</span><span class="p">);</span>
</pre></div>
</div>
<p>Of course don’t forget make a similar change the method in the <code class="docutils literal notranslate"><span class="pre">Camera.cpp</span></code> file. If you attempt to compile the program a compiler error will be thrown up because we also need to pass the <code class="docutils literal notranslate"><span class="pre">window</span></code> object into the method, so in the <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> file make this change</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Get the view and projection matrices from the camera library</span>
<span class="n">camera</span><span class="p">.</span><span class="n">calculateMatrices</span><span class="p">(</span><span class="n">window</span><span class="p">);</span>
</pre></div>
</div>
<p>Now that the <code class="docutils literal notranslate"><span class="pre">calculateMatrices()</span></code> method can take in keyboard inputs we need to capture the key presses and make appropriate changes to the <code class="docutils literal notranslate"><span class="pre">position</span></code> attribute. Define three Camera class vectors <code class="docutils literal notranslate"><span class="pre">front</span></code>, <code class="docutils literal notranslate"><span class="pre">right</span></code> and <code class="docutils literal notranslate"><span class="pre">up</span></code> in the <code class="docutils literal notranslate"><span class="pre">camera.hpp</span></code> file</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="w"> </span><span class="n">front</span><span class="p">;</span>
<span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="w"> </span><span class="n">right</span><span class="p">;</span>
<span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="w"> </span><span class="n">up</span><span class="p">;</span>
</pre></div>
</div>
<p>and instantiate them in the class constructor in <code class="docutils literal notranslate"><span class="pre">camera.cpp</span></code>.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">front</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.0f</span><span class="p">);</span>
<span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="p">(</span><span class="mf">1.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">);</span>
<span class="n">up</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="p">(</span><span class="mf">0.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0f</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">);</span>
</pre></div>
</div>
<p>Here we have defined the defaults so the camera is pointing down the <span class="math notranslate nohighlight">\(z\)</span>-axis. To move the camera we simply need to add these vectors to the <code class="docutils literal notranslate"><span class="pre">position</span></code> vector, for example to move the camera forward and back we add or subtract the <code class="docutils literal notranslate"><span class="pre">front</span></code> vector.</p>
<figure class="align-default">
<a class="reference internal image-reference" href="../_images/07_camera_movement.svg"><img alt="../_images/07_camera_movement.svg" src="../_images/07_camera_movement.svg" width="500" /></a>
</figure>
<p>No we can add the following code to the Camera class constructor before the <code class="docutils literal notranslate"><span class="pre">view</span></code> matrix is calculated.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Keyboard inputs</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">GLFW_KEY_W</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">front</span><span class="p">;</span><span class="w"> </span><span class="c1">// move forward</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">GLFW_KEY_S</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">front</span><span class="p">;</span><span class="w"> </span><span class="c1">// move backwards</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">GLFW_KEY_A</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">right</span><span class="p">;</span><span class="w"> </span><span class="c1">// move left</span>
<span class="p">}</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">GLFW_KEY_D</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">right</span><span class="p">;</span><span class="w"> </span><span class="c1">// move right</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">glfwGetKey(window,</span> <span class="pre">GLFW_KEY_W)</span></code> returns a true value if the W key has been pressed. An if statement is then used to add the <code class="docutils literal notranslate"><span class="pre">front</span></code> vector to the camera <code class="docutils literal notranslate"><span class="pre">position</span></code> vector thereby moving the camera forward. We’ve done similar to move the camera backwards, to the left and right using the classic WSAD key combinations.</p>
<p>Since we now have the ability to change the <code class="docutils literal notranslate"><span class="pre">positon</span></code> vector we should also update the <code class="docutils literal notranslate"><span class="pre">target</span></code> vector so that the camera direction does change (we do this below using mouse inputs). Just before we calculate the <code class="docutils literal notranslate"><span class="pre">view</span></code> matrix add the following code.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Update target</span>
<span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">front</span><span class="p">;</span>
</pre></div>
</div>
<p>Compile and run the program and you should be able to move the camera around the 3D world using the keyboard.</p>
<center>
<video controls muted="true" loop="true" width="500">
    <source src="../_static/07_keyboard_1.mp4" type="video/mp4">
</video>
</center>
<section id="camera-movement-speed">
<h3><span class="section-number">7.1.1. </span>Camera movement speed<a class="headerlink" href="#camera-movement-speed" title="Permalink to this heading">#</a></h3>
<p>So it works but the camera movement is too quick resulting in controls are too sensitive. To overcome this issue we can multiply the camera direction vector by number which we can choose to adjust the speed of the camera. Edit <code class="docutils literal notranslate"><span class="pre">camera.hpp</span></code> to add a <code class="docutils literal notranslate"><span class="pre">speed</span></code> attribute to the Camera class</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Speed attributes</span>
<span class="kt">float</span><span class="w"> </span><span class="n">speed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5.0f</span><span class="p">;</span>
</pre></div>
</div>
<p>Here we have specified that we want our camera to move at a speed of 5 units per second. Speed is distance divided time so we also need to know how much time has elapsed between the rendering of each frame. This is easily done using the <code class="docutils literal notranslate"><span class="pre">glfwGetTime()</span></code> function we have used to <a class="reference internal" href="05_transformations.html#animating-objects-section"><span class="std std-ref">animate objects</span></a>. In the <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> before the <code class="docutils literal notranslate"><span class="pre">main()</span></code> function add the following declarations</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Timers</span>
<span class="kt">float</span><span class="w"> </span><span class="n">currentTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
<span class="kt">float</span><span class="w"> </span><span class="n">lastTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
<span class="kt">float</span><span class="w"> </span><span class="n">deltaTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0f</span><span class="p">;</span>
</pre></div>
</div>
<p>Here we have declared the variables <code class="docutils literal notranslate"><span class="pre">currentTime</span></code> and <code class="docutils literal notranslate"><span class="pre">lastTime</span></code> which will be used to record the times that the current and previous frames are rendered and <code class="docutils literal notranslate"><span class="pre">deltaTime</span></code> which is difference between these two.</p>
<p>At the beginning of the render loop at the following code to update these timers.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Update timers</span>
<span class="n">currentTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glfwGetTime</span><span class="p">();</span>
<span class="n">deltaTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentTime</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lastTime</span><span class="p">;</span>
<span class="n">lastTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentTime</span><span class="p">;</span>
</pre></div>
</div>
<p>We need to pass <code class="docutils literal notranslate"><span class="pre">deltaTime</span></code> to the <code class="docutils literal notranslate"><span class="pre">calculateMatrices()</span></code> Camera class method so change the <code class="docutils literal notranslate"><span class="pre">camera.hpp</span></code> and <code class="docutils literal notranslate"><span class="pre">camera.cpp</span></code> files so that the method declaration look like the following.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">calculateMatrices</span><span class="p">(</span><span class="n">GLFWwindow</span><span class="o">*</span><span class="w"> </span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">deltaTime</span><span class="p">)</span>
</pre></div>
</div>
<p>Also don’t forget to change the method call in <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code>. We can now apply the <code class="docutils literal notranslate"><span class="pre">speed</span></code> attribute to the movement calculations, for example</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">glfwGetKey</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">GLFW_KEY_W</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">position</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">front</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">deltaTime</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">speed</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The result of making these changes means that the camera now moves at 5 units per second (since <span class="math notranslate nohighlight">\(\tt front\)</span> and <span class="math notranslate nohighlight">\(\tt right\)</span> are <a class="reference internal" href="04_vectors_and_matrices.html#unit-vectors-section"><span class="std std-ref">unit vectors</span></a>) is shown below.</p>
<center>
<video controls muted="true" loop="true" width="500">
    <source src="../_static/07_keyboard_2.mp4" type="video/mp4">
</video>
</center>
</section>
</section>
<section id="using-the-mouse-to-point-the-camera">
<h2><span class="section-number">7.2. </span>Using the mouse to point the camera<a class="headerlink" href="#using-the-mouse-to-point-the-camera" title="Permalink to this heading">#</a></h2>
<p>We can now move the camera position using keyboard inputs but we can’t yet change the direction of camera, to do this we can use the mouse. First we need to tell GLFW to capture the mouse inputs so add the following code after where we told it to capture the keyboard inputs in the <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> file.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Tell GLFW to capture our mouse</span>
<span class="n">glfwSetInputMode</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="n">GLFW_CURSOR</span><span class="p">,</span><span class="w"> </span><span class="n">GLFW_CURSOR_DISABLED</span><span class="p">);</span>
<span class="n">glfwPollEvents</span><span class="p">();</span>
<span class="n">glfwSetCursorPos</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="mi">1024</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">768</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">glfwSetInputMode()</span></code> and <code class="docutils literal notranslate"><span class="pre">glfwPollEvents()</span></code> functions tell GLFW to expect mouse input and also disable the cursor so it isn’t shown on the window. The <code class="docutils literal notranslate"><span class="pre">gflwSetCursorPos()</span></code> initialises the cursor to be in the center of the window using the width and height window size.</p>
<p>We now need to change the Camera class method <code class="docutils literal notranslate"><span class="pre">calculateMatrices()</span></code> to get the mouse cursor positions. In the <code class="docutils literal notranslate"><span class="pre">camera.cpp</span></code> add the following code just before we update the <code class="docutils literal notranslate"><span class="pre">target</span></code> vector.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Get mouse cursor position</span>
<span class="kt">double</span><span class="w"> </span><span class="n">xPos</span><span class="p">,</span><span class="w"> </span><span class="n">yPos</span><span class="p">;</span>
<span class="n">glfwGetCursorPos</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">xPos</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">yPos</span><span class="p">);</span>
<span class="n">glfwSetCursorPos</span><span class="p">(</span><span class="n">window</span><span class="p">,</span><span class="w"> </span><span class="mi">1024</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">768</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>Here we declare two doubles (a floating point number that uses 8 bytes instead of 4 used by the float type) <code class="docutils literal notranslate"><span class="pre">xPos</span></code> and <code class="docutils literal notranslate"><span class="pre">yPos</span></code> and use the function <code class="docutils literal notranslate"><span class="pre">glfwGetCursorPos()</span></code> to get the cursor position before resetting it back to the centre of the window using <code class="docutils literal notranslate"><span class="pre">glfwSetCursorPos()</span></code> (if we didn’t do this the cursor could go outside of the window and we would be able to use it anymore).</p>
<section id="pitch-and-yaw">
<h3><span class="section-number">7.2.1. </span>Pitch and yaw<a class="headerlink" href="#pitch-and-yaw" title="Permalink to this heading">#</a></h3>
<p>The values of <code class="docutils literal notranslate"><span class="pre">xPos</span></code> and <code class="docutils literal notranslate"><span class="pre">yPos</span></code> are the number of pixels across and up the window from the bottom-left hand corner pixel respectively. The inputs to the <code class="docutils literal notranslate"><span class="pre">glm::lookAt()</span></code> function require the camera <code class="docutils literal notranslate"><span class="pre">front</span></code> vector so we need a way of converting from the position of the cursor to a vector. To do this we first calculate the yaw and pitch angles. Consider <a class="reference internal" href="#roll-pitch-yaw-figure"><span class="std std-numref">Fig. 7.1</span></a> which shows <span class="math notranslate nohighlight">\(\tt front\)</span>, <span class="math notranslate nohighlight">\(\tt right\)</span> and <span class="math notranslate nohighlight">\(\tt up\)</span> camera vectors.</p>
<figure class="align-default" id="roll-pitch-yaw-figure">
<a class="reference internal image-reference" href="../_images/07_euler_angles.svg"><img alt="../_images/07_euler_angles.svg" src="../_images/07_euler_angles.svg" width="350" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.1 </span><span class="caption-text">Yaw, pitch and roll</span><a class="headerlink" href="#roll-pitch-yaw-figure" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>If the user moves the mouse up or down on the window then we want the camera to angle up or down to reflect this, this is the <span class="math notranslate nohighlight">\(\tt pitch\)</span> angle. Likewise when the user moves the mouse left or right we want the camera to angle left or right, this is the <span class="math notranslate nohighlight">\(\tt yaw\)</span> angle. Add two attributes <code class="docutils literal notranslate"><span class="pre">pitch</span></code> and <code class="docutils literal notranslate"><span class="pre">yaw</span></code> to the Camera class by adding the following code to <code class="docutils literal notranslate"><span class="pre">camera.hpp</span></code></p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Camera angles</span>
<span class="kt">float</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3.1415927f</span><span class="p">;</span>
<span class="kt">float</span><span class="w"> </span><span class="n">pitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pi</span><span class="p">;</span>
<span class="kt">float</span><span class="w"> </span><span class="n">yaw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pi</span><span class="p">;</span>
</pre></div>
</div>
<p>Both <code class="docutils literal notranslate"><span class="pre">pitch</span></code> and <code class="docutils literal notranslate"><span class="pre">yaw</span></code> are initialised to <span class="math notranslate nohighlight">\(\pi\)</span> (which is the equivalent to 180<span class="math notranslate nohighlight">\(^\circ\)</span>) since the camera is looking down the <span class="math notranslate nohighlight">\(z\)</span>-axis. We want these angles to update for each frame so in the <code class="docutils literal notranslate"><span class="pre">calculateMatrices()</span></code> Camera class method add the following code after <code class="docutils literal notranslate"><span class="pre">xPos</span></code> and <code class="docutils literal notranslate"><span class="pre">yPos</span></code> have been determined.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Update yaw and pitch angles</span>
<span class="n">yaw</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="kt">float</span><span class="p">(</span><span class="n">xPos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1024</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">pitch</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="kt">float</span><span class="p">(</span><span class="n">yPos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">768</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>The <span class="math notranslate nohighlight">\(\tt yaw\)</span> and <span class="math notranslate nohighlight">\(\tt pitch\)</span> angles increase when the cursor is moved to the right and above the window centre respectively. We now have <span class="math notranslate nohighlight">\(\tt yaw\)</span> and <span class="math notranslate nohighlight">\(\tt pitch\)</span> angles and need to convert to camera vectors. Using spherical to Cartesian conversion the <span class="math notranslate nohighlight">\(\tt front\)</span> vector is</p>
<div class="math notranslate nohighlight">
\[ \begin{align*}
  \tt front &amp;= \textsf{normalise}(\sin(\tt yaw) \cos(\tt pitch), \sin(\tt pitch), -\cos(\tt yaw) \cos(\tt pitch)).
\end{align*} \]</div>
<p>You don’t necessarily need to know where this comes from but if you are curious click on the dropdown below.</p>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header">
Calculating the front vector from the yaw and pitch angles<div class="sd-summary-down docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="sd-summary-up docutils">
<svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">First consider the left-to-right movement, since we use <code class="docutils literal notranslate"><span class="pre">xPos</span> <span class="pre">-</span> <span class="pre">1024/2</span></code> to calculate the <span class="math notranslate nohighlight">\(\tt yaw\)</span> angle, if we move the cursor to the right then the <span class="math notranslate nohighlight">\(\tt yaw\)</span> angle increases and we want to rotate <strong>clockwise</strong> about the <span class="math notranslate nohighlight">\(y\)</span>-axis (<a class="reference internal" href="#yaw-figure"><span class="std std-numref">Fig. 7.2</span></a>).</p>
<figure class="align-default" id="yaw-figure">
<a class="reference internal image-reference" href="../_images/03_yaw.svg"><img alt="../_images/03_yaw.svg" src="../_images/03_yaw.svg" width="250" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.2 </span><span class="caption-text">Yaw movement is rotation about the <span class="math notranslate nohighlight">\(y\)</span>-axis.</span><a class="headerlink" href="#yaw-figure" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p class="sd-card-text">The <a class="reference internal" href="05_transformations.html#rotation-section"><span class="std std-ref">rotation matrix</span></a> is (note the negative sign for the <span class="math notranslate nohighlight">\(\sin\)</span> function is switched to the bottom left)</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align*}
  R_y &amp;=
  \begin{pmatrix}
    \cos(\tt yaw) &amp; 0 &amp; \sin(\tt yaw) \\
    0 &amp; 1 &amp; 0 \\
    -\sin(\tt yaw) &amp; 0 &amp; \cos(\tt yaw)
  \end{pmatrix}
\end{align*} \end{split}\]</div>
<p class="sd-card-text">Similarly, if we move the cursor up then <span class="math notranslate nohighlight">\(\tt pitch\)</span> angle increases and we want to rotate <strong>anti-clockwise</strong> about the <span class="math notranslate nohighlight">\(x\)</span>-axis (<a class="reference internal" href="#pitch-figure"><span class="std std-numref">Fig. 7.3</span></a>).</p>
<figure class="align-default" id="pitch-figure">
<a class="reference internal image-reference" href="../_images/03_pitch.svg"><img alt="../_images/03_pitch.svg" src="../_images/03_pitch.svg" width="200" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.3 </span><span class="caption-text">Pitch movement is rotation about the <span class="math notranslate nohighlight">\(x\)</span>-axis.</span><a class="headerlink" href="#pitch-figure" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p class="sd-card-text">The rotation matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align*}
  R_x &amp;= 
  \begin{pmatrix}
    1 &amp; 0 &amp; 0 \\
    0 &amp; \cos(\tt pitch) &amp; \sin(\tt pitch) \\
    0 &amp; -\sin(\tt pitch) &amp; \cos(\tt pitch)
  \end{pmatrix}
\end{align*} \end{split}\]</div>
<p class="sd-card-text">Applying these rotations to the <span class="math notranslate nohighlight">\(\tt front\)</span> vector (0,0,-1)</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align*}
  \tt newFront &amp;= (0, 0, -1)
  \begin{pmatrix}
    1 &amp; 0 &amp; 0 \\
    0 &amp; \cos(\tt pitch) &amp; \sin(\tt pitch) \\
    0 &amp; -\sin(\tt pitch) &amp; \cos(\tt pitch)
  \end{pmatrix} 
  \begin{pmatrix}
    \cos(\tt yaw) &amp; 0 &amp; \sin(\tt yaw) \\
    0 &amp; 1 &amp; 0 \\
    -\sin(\tt yaw) &amp; 0 &amp; \cos(\tt yaw)
  \end{pmatrix}\\
  &amp;=
  (0, 0, -1)
  \begin{pmatrix}
    \cos(\tt yaw) &amp; 0 &amp; 0 \sin(\tt yaw) \\
    -\sin(\tt yaw)\sin(\tt pitch) &amp; \cos(\tt pitch) &amp; \cos(\tt yaw)\sin(\tt pitch) \\
    -\sin(\tt yaw)\cos(\tt pitch)  &amp; -\sin(\tt pitch) &amp; \cos(\tt yaw)\cos(\tt pitch)
  \end{pmatrix} \\
  &amp;= (\sin(\tt yaw)\cos(\tt pitch), sin(\tt pitch), -\cos(\tt yaw)\cos(\tt pitch))
\end{align*} \end{split}\]</div>
<p class="sd-card-text">which gives the updated <span class="math notranslate nohighlight">\(\tt front\)</span> vector from the <span class="math notranslate nohighlight">\(\tt yaw\)</span> and <span class="math notranslate nohighlight">\(\tt pitch\)</span> angles.</p>
</div>
</details><p>The <span class="math notranslate nohighlight">\(\tt right\)</span> and <span class="math notranslate nohighlight">\(\tt up\)</span> camera vectors are calculated in a similar was to how we calculated the <code class="docutils literal notranslate"><span class="pre">view</span></code> matrix in <a class="reference internal" href="06_3D_worlds.html#view-matrix-section"><span class="std std-ref">Lab 6</span></a>, i.e.,</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{align*}
  \tt right &amp;= \textsf{normalise}(\tt front \times worldUp), \\
  \tt up &amp;= \textsf{normalise}(\tt right \times front),
\end{align*} \end{split}\]</div>
<p>and the <span class="math notranslate nohighlight">\(\tt target\)</span> vector is</p>
<div class="math notranslate nohighlight">
\[ \tt target = position + front. \]</div>
<p>Add the following code to the <code class="docutils literal notranslate"><span class="pre">camera.cpp</span></code> file after we have updated the <span class="math notranslate nohighlight">\(\tt yaw\)</span> and <span class="math notranslate nohighlight">\(\tt pitch\)</span> angles.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Update camera vectors</span>
<span class="n">front</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">normalize</span><span class="p">(</span><span class="n">glm</span><span class="o">::</span><span class="n">vec3</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pitch</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">sin</span><span class="p">(</span><span class="n">pitch</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">yaw</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cos</span><span class="p">(</span><span class="n">pitch</span><span class="p">)));</span>
<span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">normalize</span><span class="p">(</span><span class="n">glm</span><span class="o">::</span><span class="n">cross</span><span class="p">(</span><span class="n">front</span><span class="p">,</span><span class="w"> </span><span class="n">worldUp</span><span class="p">));</span>
<span class="n">up</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">glm</span><span class="o">::</span><span class="n">normalize</span><span class="p">(</span><span class="n">glm</span><span class="o">::</span><span class="n">cross</span><span class="p">(</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">front</span><span class="p">));</span>
<span class="n">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">front</span><span class="p">;</span>
</pre></div>
</div>
<p>If you compile and run your program you may notice that the mouse controls are far too sensitive and we need to slow down the speed of rotation. To do this add an attribute to the Camera class in <code class="docutils literal notranslate"><span class="pre">camera.hpp</span></code> called <code class="docutils literal notranslate"><span class="pre">mouseSpeed</span></code> and initialise it to some small number (you may need to experiment with this value).</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="kt">float</span><span class="w"> </span><span class="n">mouseSpeed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.005f</span><span class="p">;</span>
</pre></div>
</div>
<p>Then change the <code class="docutils literal notranslate"><span class="pre">yaw</span></code> and <code class="docutils literal notranslate"><span class="pre">pitch</span></code> calculations in <code class="docutils literal notranslate"><span class="pre">camera.cpp</span></code> to the following</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Update yaw and pitch angles</span>
<span class="n">yaw</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mouseSpeed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">float</span><span class="p">(</span><span class="n">xPos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1024</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
<span class="n">pitch</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mouseSpeed</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">float</span><span class="p">(</span><span class="n">yPos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">768</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>Running the program now gives a much better result.</p>
<center>
<video controls muted="true" loop="true" width="500">
    <source src="../_static/07_mouse.mp4" type="video/mp4">
</video>
</center>
</section>
<section id="constraining-the-pitch-angle">
<h3><span class="section-number">7.2.2. </span>Constraining the pitch angle<a class="headerlink" href="#constraining-the-pitch-angle" title="Permalink to this heading">#</a></h3>
<p>Whilst playing with the camera direction you may have noticed that when you attempt to look straight up or down upon the objects the camera suddenly flips. This is because of how we calculate the <code class="docutils literal notranslate"><span class="pre">view</span></code> vector. To prevent this we need to constrain the <code class="docutils literal notranslate"><span class="pre">pitch</span></code> angle so it is between <span class="math notranslate nohighlight">\(\frac{1}{2}\pi\)</span> and <span class="math notranslate nohighlight">\(\frac{3}{2} \pi\)</span> (equivalent to 90<span class="math notranslate nohighlight">\(^\circ\)</span> and 270<span class="math notranslate nohighlight">\(^\circ\)</span> respectively). To do this we simply add the following if statements after updating the <code class="docutils literal notranslate"><span class="pre">yaw</span></code> and <code class="docutils literal notranslate"><span class="pre">pitch</span></code> angles.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Constrain pitch angle so the screen doesn&#39;t flip when looking straight up or down</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pitch</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">1.49f</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="p">)</span>
<span class="w">    </span><span class="n">pitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.49f</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pitch</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.51f</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="p">)</span>
<span class="w">    </span><span class="n">pitch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.51f</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>
<section id="back-face-culling">
<h2><span class="section-number">7.3. </span>Back face culling<a class="headerlink" href="#back-face-culling" title="Permalink to this heading">#</a></h2>
<p>Whilst moving your camera around your 3D world you may notice that we can move through objects and view them from the inside. All surfaces of the cubes are rendered, including those not visible from the camera because they are on the far side. This is a waste of resources as OpenGL is calculating the vertex and fragment shaders for objects that won’t be shown in the frame. To overcome this we can cull (omit) any surface of an object that is <strong>back facing</strong> the camera in a method called <strong>back face culling</strong>.</p>
<p id="normal-vector-section">A <strong>normal vector</strong> (often just referred to as a <strong>normal</strong>) is a vector that is perpendicular to a surface at a given point (<a class="reference internal" href="#normal-vector-figure"><span class="std std-numref">Fig. 7.4</span></a>).</p>
<figure class="align-default" id="normal-vector-figure">
<a class="reference internal image-reference" href="../_images/07_normal_vector.svg"><img alt="../_images/07_normal_vector.svg" src="../_images/07_normal_vector.svg" width="250" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.4 </span><span class="caption-text">The surface normal vector.</span><a class="headerlink" href="#normal-vector-figure" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Since in computer graphics are surfaces are triangles, we can easily calculate a normal vector using a <a class="reference internal" href="04_vectors_and_matrices.html#cross-product-section"><span class="std std-ref">cross product</span></a>. If a triangle has vertices <span class="math notranslate nohighlight">\(\tt v0\)</span>, <span class="math notranslate nohighlight">\(\tt v1\)</span> and <span class="math notranslate nohighlight">\(\tt v2\)</span> then the normal vector can be calculated using</p>
<div class="math notranslate nohighlight">
\[ \tt normal = (v1 - v0) \times (v2 - v1). \]</div>
<p>A surface is said to be back facing it its normal vector is pointing away from the camera position. If we only render the front facing surfaces then, assuming the surfaces are opaque, we should not notice any difference and we have halved the number of surfaces the shader has to deal with (<a class="reference internal" href="#backface-culling-figure"><span class="std std-numref">Fig. 7.5</span></a>).</p>
<figure class="align-default" id="backface-culling-figure">
<a class="reference internal image-reference" href="../_images/07_backface_culling.svg"><img alt="../_images/07_backface_culling.svg" src="../_images/07_backface_culling.svg" width="300" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.5 </span><span class="caption-text">Back face culling removes surfaces with vectors pointing away from the camera.</span><a class="headerlink" href="#backface-culling-figure" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>But how do we know if a surface is back facing? Consider <a class="reference internal" href="#back-facing-figure"><span class="std std-numref">Fig. 7.6</span></a> which shows a back facing surface.</p>
<figure class="align-default" id="back-facing-figure">
<a class="reference internal image-reference" href="../_images/07_Back_facing.svg"><img alt="../_images/07_Back_facing.svg" src="../_images/07_Back_facing.svg" width="400" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.6 </span><span class="caption-text">A back facing surface.</span><a class="headerlink" href="#back-facing-figure" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Recall that the <a class="reference internal" href="04_vectors_and_matrices.html#dot-product-section"><span class="std std-ref">dot product</span></a> is related to the angle between two vectors, i.e.,</p>
<div class="math notranslate nohighlight">
\[ \tt normal \cdot \text{viewVector} = | normal | | \text{viewVector} | \cos(\theta). \]</div>
<p>If we have a back facing surface then <span class="math notranslate nohighlight">\(\theta\)</span> is less than 90<span class="math notranslate nohighlight">\(^\circ\)</span> and <span class="math notranslate nohighlight">\(\cos(\theta)\)</span> is a positive number so</p>
<div class="math notranslate nohighlight">
\[\begin{align*}
  \tt normal \cdot \text{viewVector} &gt; 0.
\end{align*}\]</div>
<p>So to apply back face culling the vertex shader just has to calculate the dot product between the <span class="math notranslate nohighlight">\(\tt normal\)</span> and <span class="math notranslate nohighlight">\(\tt viewVector\)</span> vectors and if it is a positive number it ignores the surface from then on. To apply back face culling in OpenGL all we need to do is add the following code to the <code class="docutils literal notranslate"><span class="pre">main.cpp</span></code> near where we invoke the depth testing.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="c1">// Use back face culling</span>
<span class="n">glEnable</span><span class="p">(</span><span class="n">GL_CULL_FACE</span><span class="p">);</span>
</pre></div>
</div>
<p>Compile and run your program and use the keyboard and mouse to put the camera inside a cube. You will now see that the back faces haven’t been rendered.</p>
</section>
<hr class="docutils" />
<section id="exercises">
<h2><span class="section-number">7.4. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Change the <code class="docutils literal notranslate"><span class="pre">calculateMatrices()</span></code> Camera class method so that the camera position always has a <span class="math notranslate nohighlight">\(y\)</span> co-ordinate of 0, i.e., like a first person shooter game where the player cannot fly around the world.</p></li>
<li><p>Add the ability for the user to perform a jump by pressing the space bar. The jump should last for 1 second and the camera should follow a smooth arc. Hint: the function <span class="math notranslate nohighlight">\(y = \tt height \cdot \sin(\pi \cdot \tt time)\)</span> produces values of <span class="math notranslate nohighlight">\(y=0\)</span> when <span class="math notranslate nohighlight">\(\tt time = 0\)</span> or <span class="math notranslate nohighlight">\(\tt time = 1\)</span> and <span class="math notranslate nohighlight">\(y = \tt height\)</span> when <span class="math notranslate nohighlight">\(\tt time = 0.5\)</span>.</p></li>
<li><p>Write your own class called <code class="docutils literal notranslate"><span class="pre">MyLib</span></code> with static member functions for each of the functions you have used from the glm library (e.g., <code class="docutils literal notranslate"><span class="pre">lookAt()</span></code>) and make use of them to calculate the <code class="docutils literal notranslate"><span class="pre">model</span></code>, <code class="docutils literal notranslate"><span class="pre">view</span></code> and <code class="docutils literal notranslate"><span class="pre">projection</span></code> matrices (you may make use of <code class="docutils literal notranslate"><span class="pre">glm::mat4</span></code> and <code class="docutils literal notranslate"><span class="pre">glm::vec3</span></code> types).</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="source-code">
<h2><span class="section-number">7.5. </span>Source code<a class="headerlink" href="#source-code" title="Permalink to this heading">#</a></h2>
<p>The source code for this lab, including the exercise solutions, can be downloaded using the links below.</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/2cb20fb55b161f0a593e176e689c1a78/main.cpp"><span class="xref download myst">main.cpp</span></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/82f776da1bce6569904d974dd6e8bfe5/camera.hpp"><span class="xref download myst">camera.hpp</span></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/63099aebb3a55e97724676f744e7fa4a/camera.cpp"><span class="xref download myst">camera.cpp</span></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/6b9eec484dca75bfb3ea5936867fb09d/camera_exercises.hpp"><span class="xref download myst">camera_exercises.hpp</span></a> (solution to exercise 1 and 2)</p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/2333d9c7a8419800b5707547d4ccadba/camera_exercises.cpp"><span class="xref download myst">camera_exercises.cpp</span></a></p></li>
</ul>
<p>Note the solution to exercise 3 has been omitted since it is a requirement for the higher mark band on the coursework assignment.</p>
</section>
<section id="video-walkthrough">
<h2><span class="section-number">7.6. </span>Video walkthrough<a class="headerlink" href="#video-walkthrough" title="Permalink to this heading">#</a></h2>
<p>The video below walks you through these lab materials.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/JJUgf9GCN_4?si=0MDnzyWHUxB0R22f" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="06_3D_worlds.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>3D Worlds</p>
      </div>
    </a>
    <a class="right-next"
       href="08_Lighting.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8. </span>Lighting</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-keyboard-input-to-move-the-camera">7.1. Using keyboard input to move the camera</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#camera-movement-speed">7.1.1. Camera movement speed</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-mouse-to-point-the-camera">7.2. Using the mouse to point the camera</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pitch-and-yaw">7.2.1. Pitch and yaw</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constraining-the-pitch-angle">7.2.2. Constraining the pitch angle</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#back-face-culling">7.3. Back face culling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">7.4. Exercises</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-code">7.5. Source code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#video-walkthrough">7.6. Video walkthrough</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Jon Shiach
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>